# Family Book Keeper - Cursor Rules

## Testing Requirements

**All new functionality MUST include tests.** When adding new functions, hooks, or significant logic:
1. Write tests for the new functionality BEFORE considering the task complete
2. Tests must cover the happy path and error cases
3. Perform mutation testing to verify tests are meaningful

When writing unit tests, ALWAYS perform mutation testing:

1. After writing a test, introduce a breaking change to the code being tested
2. Run the test to confirm it FAILS
3. Revert the change and confirm the test PASSES
4. Only commit tests that have been verified this way

### Example Mutations

- Change `return value` to `return 'BROKEN'`
- Invert boolean: `!!user` â†’ `!user`
- Change error messages
- Return null instead of actual value

### Test Commands

```bash
cd mobile/android
npm test              # Run all tests
npm run test:watch    # Watch mode  
npm run test:coverage # With coverage
```

## Code Style

- Use TypeScript strict mode
- Follow existing patterns in the codebase
- Keep functions small and focused
- Add JSDoc comments for public APIs

## Firebase/Expo

- Run builds from `mobile/android/` directory
- Native modules require dev client (not Expo Go)
- Keep Firebase config files in project root

## Internationalization (i18n)

- All user-facing strings must be translated using `t('key')` from `useTranslation()`
- When editing UI files, scan for hardcoded strings and replace with translations
- Add translations to both `locales/en.json` and `locales/he.json`
- See `.cursor/rules/i18n.mdc` for detailed guidelines

